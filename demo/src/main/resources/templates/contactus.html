<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contact Us</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="icon" href="images/logo.jpg" type="image/x-icon" />
    <style>
      body {
        background-color: #f3f3f3;
        padding: 20px;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1,
      h3 {
        color: #333;
      }
      .form-control {
        width: 100%;
      }
      .btn-outline-primary,
      .btn-outline-info,
      .btn-outline-secondary {
        margin-right: 10px;
      }
      footer {
        margin-top: 20px;
        text-align: center;
        color: #777;
      }
      .error {
        color: red;
        font-size: 0.875em;
      }
      .thank-you-message {
        display: none;
        background: #d4edda;
        padding: 20px;
        border: 1px solid #c3e6cb;
        border-radius: 8px;
        color: #155724;
        margin-top: 20px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <p><span id="loggedInEmailDisplay"></span></p>
    <div class="container">
      <nav class="navbar navbar-light">
        <a class="navbar-brand" href="#">
          <img
            src="images/logo.jpg"
            height="70"
            class="d-inline-block align-top"
            alt=""
          />
        </a>
        <ul class="nav justify-content-end">
          <li class="nav-item">
            <a href="explorersatlas" class="nav-link text-success">Home</a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link text-success">Packages</a>
          </li>
          <li class="nav-item">
            <a href="aboutus.html" class="nav-link text-success">About us</a>
          </li>

          <li class="nav-item">
            <a href="reviews" class="nav-link text-success">Reviews</a>
          </li>
        </ul>
      </nav>
      <div class="text-center">
        <h1 class="text-success">Contact Us</h1>
        <p>We're here to help you plan your perfect trip!</p>
      </div>
      <div>
        <h3 class="text-success">Customer Service</h3>
        <p><strong>Phone:</strong> Toll-Free: 1-800-123-4567</p>
        <p>
          <strong>Email:</strong> General Inquiries: support@explorersatlas.com
          , Booking Assistance: booking@explorersatlas.com
        </p>
        <p>
          <strong>Working Hours:</strong> Mon-Fri: 8:00 AM - 6:00 PM (IST),
          Sat-Sun: 9:00 AM - 5:00 PM
        </p>
      </div>
      <h3 class="text-success">Quick Inquiry Form</h3>
      <form id="contactForm" onsubmit="return validateForm()">
        <div class="mb-3">
          <label for="name" class="form-label">Your Name</label>
          <input
            type="text"
            class="form-control"
            id="name"
            placeholder="Enter your Name"
          />
          <div id="nameError" class="error"></div>
        </div>
        <div class="mb-3">
          <label for="Email" class="form-label">Your Email</label>
          <input
            type="email"
            class="form-control"
            id="Email"
            placeholder="Enter your Email"
          />
          <div id="emailError" class="error"></div>
        </div>
        <div class="mb-3">
          <label for="Subject" class="form-label">Subject</label>
          <input
            type="text"
            class="form-control"
            id="Subject"
            placeholder="Subject of your Message"
          />
          <div id="subjectError" class="error"></div>
        </div>
        <div class="mb-3">
          <label for="message" class="form-label">Message</label>
          <textarea
            class="form-control"
            id="message"
            rows="5"
            placeholder="Your message"
          ></textarea>
          <div id="messageError" class="error"></div>
        </div>
        <div class="mb-3">
          <label>Preferred Contact Method</label><br />
          <div class="form-check form-check-inline">
            <input
              class="form-check-input"
              type="radio"
              name="contactMethod"
              id="emailContact"
              value="email"
            />
            <label class="form-check-label" for="emailContact">Email</label>
          </div>
          <div class="form-check form-check-inline">
            <input
              class="form-check-input"
              type="radio"
              name="contactMethod"
              id="phoneContact"
              value="phone"
            />
            <label class="form-check-label" for="phoneContact">Phone</label>
          </div>
          <div id="contactMethodError" class="error"></div>
        </div>
        <button type="submit" class="btn btn-success">Submit</button>
      </form>

      <!-- Thank You Message Section -->
      <div id="thankYouMessage" class="thank-you-message">
        <h4>Thank you for contacting us!</h4>
        <p>
          Your message has been successfully submitted. We will get back to you
          shortly.
        </p>
      </div>

      <div class="text-center mt-4">
        <h3 class="text-success">Follow Us</h3>
        <p>Stay updated on travel tips and deals:</p>
        <p>
          <a href="#" class="btn btn-outline-success">Facebook</a>
          <a href="#" class="btn btn-outline-success">Instagram</a>
          <a href="#" class="btn btn-outline-success">Twitter</a>
        </p>
      </div>
      <div>
        <h3 class="text-success">Our Office Locations</h3>
        <ul>
          <li>
            <strong>New Delhi Office:</strong> 123 Main Street, New Delhi,
            India, 110001
          </li>
          <li>
            <strong>Hyderabad Office:</strong> 456 Travel Street, Hyderabad,
            India, 500070
          </li>
          <li>
            <strong>Mumbai Office:</strong> 789 Holiday Blvd, Mumbai, India,
            400001
          </li>
        </ul>
      </div>
      <footer>
        <p>&copy; 2024 Explorer's Atlas. All rights reserved.</p>
      </footer>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kP6eWLV8/MN4uAekN6fr5h4uG/3AjuN91bVYlBUv0QLX5E9Vq8bh9bd9PBl9+1vd"
      crossorigin="anonymous"
    ></script>
    <script>
      let globalUserEmail = null;
      function fetchUsername() {
        fetch("/username")
          .then((response) => {
            if (!response.ok) {
              throw new Error(
                "Network response was not ok: " + response.statusText
              );
            }
            return response.text();
          })
          .then((data) => {
            console.log("Retrieved Email (from /username endpoint):", data);

            const emailDisplayElement = document.getElementById(
              "loggedInEmailDisplay"
            );
            if (emailDisplayElement) {
            } else {
              console.warn(
                "Element with ID 'loggedInEmailDisplay' not found to display email."
              );
            }

            const emailInput = document.getElementById("Email");
            if (emailInput) {
              if (
                data &&
                data !== "No email found in session. Please register or log in."
              ) {
                emailInput.value = data;
                globalUserEmail = data;
                emailInput.readOnly = true;
                emailInput.style.backgroundColor = "#f0f0f0";
              } else {
                emailInput.value = "";
                emailInput.readOnly = false;
                emailInput.style.backgroundColor = "";
                globalUserEmail = null;
              }
            } else {
              console.warn(
                "Email input element with ID 'Email' not found in contact form."
              );
            }
            return data;
          })
          .catch((error) => {
            console.error("Error fetching email for auto-fill:", error);
            const errorDisplayElement = document.getElementById("errorDisplay");
            if (errorDisplayElement) {
              errorDisplayElement.textContent =
                "Error loading email: " + error.message;
            }
            const emailInput = document.getElementById("Email");
            if (emailInput) {
              emailInput.value = "";
              emailInput.readOnly = false;
              emailInput.style.backgroundColor = "";
            }
          });
      }
      function validateForm() {
        let valid = true;
        document.getElementById("nameError").textContent = "";
        document.getElementById("emailError").textContent = "";
        document.getElementById("subjectError").textContent = "";
        document.getElementById("messageError").textContent = "";
        document.getElementById("contactMethodError").textContent = "";

        let name = document.getElementById("name").value;
        if (name === "") {
          document.getElementById("nameError").textContent =
            "Name is required.";
          valid = false;
        }
        let email = document.getElementById("Email").value;
        let emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
        if (email === "" || !emailPattern.test(email)) {
          document.getElementById("emailError").textContent =
            "Please enter a valid email address.";
          valid = false;
        }

        let subject = document.getElementById("Subject").value;
        if (subject === "") {
          document.getElementById("subjectError").textContent =
            "Subject is required.";
          valid = false;
        }

        let message = document.getElementById("message").value;
        if (message === "") {
          document.getElementById("messageError").textContent =
            "Message cannot be empty.";
          valid = false;
        }
        let contactMethod = document.querySelector(
          'input[name="contactMethod"]:checked'
        );
        if (!contactMethod) {
          document.getElementById("contactMethodError").textContent =
            "Please select a preferred contact method.";
          valid = false;
        }

        if (valid) {
          fetch('/api/contact',{
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              name: document.getElementById('name').value,
              email: document.getElementById('Email').value,
              subject: document.getElementById('Subject').value,
              message: document.getElementById('message').value,
              contactMethod: document.querySelector('input[name="contactMethod"]:checked').value
            })
          })
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .catch(error => {
            console.error('Error submitting form:', error);
          });
          document.getElementById("contactForm").style.display = "none";
          document.getElementById("thankYouMessage").style.display = "block";
        }
        return false;
      }
      document.addEventListener("DOMContentLoaded", fetchUsername);
    </script>
    <script src="username.js"></script>
  </body>
</html>
